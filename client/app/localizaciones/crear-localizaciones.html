<style>
  .angular-google-map-container { height: 400px; width: 600px;  }
</style>

<section class="page-top">
	<div class="container">
		<div class="row">
			<div class="col-md-12">
				<ul class="breadcrumb">
					<li><a href="#">Inicio</a></li>
					<li class="active">Mapa</li>
				</ul>
			</div>
		</div>
		<div class="row">
			<div class="col-md-12">
				<h1>Sube tu fotografía</h1>
			</div>
		</div>
	</div>
</section>
<div class="container">
	<div class="row">
		<div class="col-md-7">
		<div class="form-group">
					<label>Selecciona la localización exacta</label> <span ng-show="!marker.coords.latitude>0" style="color:red">*</span><small>(Haz click en el mapa para situar el punto sobre el mapa)</small>
					<!--<div style="position:absolute;width:300px;top:40px;left:140px;z-index: 9999;">
									<input type="text"  g-places-autocomplete class="input-group" placeholder="Buscador..." ng-model="place" style="width: 300px;" />
									
								</div>-->
					<div class="row" ng-if="showMap">
						<ui-gmap-google-map center='map.center' zoom='map.zoom' events="map.events" bounds="map.bounds">							
							<ui-gmap-marker coords="marker.coords" options="marker.options" events="marker.events" idkey="marker.id" icon="{url:'http://res.cloudinary.com/djhqderty/image/upload/v1430472337/icono-mapa_xnqyqd.png' }" >
							 </ui-gmap-marker>

						</ui-gmap-google-map>
					</div>
					<span style="color:red">*</span> Campos obligatorios
					<div class="row">
				<div class="col-md-7">
					<h3 style="    margin-top: 30px;margin-bottom: 20px;">Reto</h3>
					<p>¿Quieres incluir tu fotografía en alguno de los retos actuales?</p>
					<select style="width: 100%;"
  ng-model="retoSelected"
  ng-options="x.nombre for x in listaRetos">
  <option value="">Selecciona un reto</option>
</select>

					<br />
					<!--<select ng-show="mostrarLocalizaciones" style="width: 100%;margin-top: 30px;"
  ng-model="localizacionSelected"
  ng-options="xx.nombre for xx in listaLocalizaciones">
<option value="">Selecciona una localización</option>
</select>-->

  
  <select ng-show="mostrarLocalizaciones" style="width: 100%;margin-top: 30px;"
  ng-model="localizacionSelected">
  <option value="">Selecciona una localización</option>
    <optgroup label="Cataluña">
   		 <option ng-repeat="lista in otraLista[0].localizacion" value="{{lista.codigoReto}}">{{lista.nombre}}</option>
    <optgroup label="Comunidad Valenciana">
    	<option ng-repeat="lista in otraLista2[0].localizacion" value="{{lista.codigoReto}}">{{lista.nombre}}</option>
  	</optgroup>
  	<optgroup label="Murcia">
    	<option ng-repeat="lista in otraListaMurcia[0].localizacion" value="{{lista.codigoReto}}">{{lista.nombre}}</option>
  	</optgroup>
  	<optgroup label="Andalucia">
    	<option ng-repeat="lista in otraListaAndalucia[0].localizacion" value="{{lista.codigoReto}}">{{lista.nombre}}</option>
  	</optgroup>
  	<optgroup label="Galicia">
    	<option ng-repeat="lista in otraListaGalicia[0].localizacion" value="{{lista.codigoReto}}">{{lista.nombre}}</option>
  	</optgroup>
  	<optgroup label="Asturias">
    	<option ng-repeat="lista in otraListaAsturias[0].localizacion" value="{{lista.codigoReto}}">{{lista.nombre}}</option>
  	</optgroup>
  	<optgroup label="Cantabria">
    	<option ng-repeat="lista in otraListaCantabria[0].localizacion" value="{{lista.codigoReto}}">{{lista.nombre}}</option>
  	</optgroup>
  	<optgroup label="Pais Vasco">
    	<option ng-repeat="lista in otraListaPaisVasco[0].localizacion" value="{{lista.codigoReto}}">{{lista.nombre}}</option>
  	</optgroup>
  	<optgroup label="Canarias">
    	<option ng-repeat="lista in otraListaCanarias[0].localizacion" value="{{lista.codigoReto}}">{{lista.nombre}}</option>
  	</optgroup>
  	<optgroup label="Islas Baleares">
    	<option ng-repeat="lista in otraListaIslasBaleares[0].localizacion" value="{{lista.codigoReto}}">{{lista.nombre}}</option>
  	</optgroup>
  	<optgroup label="Ceuta">
    	<option ng-repeat="lista in otraListaCeuta[0].localizacion" value="{{lista.codigoReto}}">{{lista.nombre}}</option>
  	</optgroup>
  	<optgroup label="Melilla">
    	<option ng-repeat="lista in otraListaMelilla[0].localizacion" value="{{lista.codigoReto}}">{{lista.nombre}}</option>
  	</optgroup>

</select>



  <!--<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">Scrollable Menu <span class="caret"></span></button>
                <ul class="dropdown-menu scrollable-menu" role="menu">
                	<li class="dropdown-header">Dropdown header 1</li>
                    <li><a href="#">Action</a></li>
                    <li><a href="#">Another action</a></li>
                    <li><a href="#">Something else here</a></li>
                    <li><a href="#">Action</a></li>
                    <li><a href="#">Another action</a></li>
                    <li><a href="#">Something else here</a></li>
                    <li><a href="#">Action</a></li>
                    <li><a href="#">Another action</a></li>
                    <li><a href="#">Something else here</a></li>
                    <li class="divider"></li>
      				<li class="dropdown-header">Dropdown header 2</li>
                    <li><a href="#">Action</a></li>
                    <li><a href="#">Another action</a></li>
                    <li><a href="#">Something else here</a></li>
                    <li><a href="#">Action</a></li>
                    <li><a href="#">Another action</a></li>
                </ul>-->
				</div>
			</div>
				</div>
			
		</div>
		<div class="col-md-5">
			<div class="row">
				<div class="form-group" ng-class="{ 'has-success': form.titulo.$valid && submitted,
					'has-error': form.titulo.$invalid && submitted }">
					<label>Título <span ng-show="!localizacion.titulo.length>0" style="color:red">*</span></label>
					
					<input type="text" name="titulo" class="form-control" ng-model="localizacion.titulo" required mongoose-error/>
					<p class="help-block" ng-show="form.titulo.$error.required && submitted">
						Olvidaste poner el título
					</p>
					<p class="help-block" ng-show="form.titulo.$error.mongoose">
						{{ errors.titulo }}
					</p>
				</div>
			</div>
			<div class="row">
				<div class="form-group" >
					<label>Fecha de la toma</label> <span ng-show="!dt.length>0" style="color:red">*</span>
					<div class="row">
						<div class="col-md-6">
							<p class="input-group">
								<input type="text" class="form-control" datepicker-popup="dd/MM/yyyy" ng-model="dt" is-open="opened" datepicker-options="dateOptions"  ng-required="true" close-text="Close" />
								<span class="input-group-btn">
									<button type="button" class="btn btn-default" ng-click="open($event)"><i class="glyphicon glyphicon-calendar"></i></button>
								</span>
							</p>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-md-7" style="margin-left: -15px;">
					<div class="form-group">
						<label>Subir fotografía</label> <span ng-show="!finalizado" style="color:red">*</span><span style="font-size:10px">(máximo 5MB)</span>
						
						<input type="file" name="file" class="cloudinary_fileupload" multiple ng-model="$parent.files">
						<div class="file" ng-repeat="file in files">
							<!--<h3><i ng-class="finalizado ? 'fa fa-check' : 'fa fa-spinner fa-pulse'"></i></h3>-->
							
							<div class="status"  ng-show="!finalizado">{{file.status}}</div>
							
							<div class="progress-bar" ng-show="!finalizado">
								<div class="progress"style="width: {{file.progress}}%" ng-init="progress=0"></div>
							</div>
							<h4 class="success" ng-show="finalizado">Carga completada</h4>
							
						
						</div>
					</div>
				</div>

			</div>
			<div class="row">
				<div class="col-md-12">
					<img ng-show="localizacion.cloudinaryId.length>0" src="http://res.cloudinary.com/djhqderty/image/upload/c_fit,w_370,q_50/{{localizacion.cloudinaryId}}"  style="margin-bottom:10px;" />
				</div>
			</div>
			<div class="row">
				<div class="form-group">
					<label>Categoria</label> <span ng-show="!(localizacion.categoria>=0)" style="color:red">*</span>
					<select style="width: 100%;" ng-model="localizacion.categoria" convert-to-number>
					 <optgroup label="Nocturnas">
						  <option value="0">Nocturna Paisaje</option>
						  <option value="1">Nocturna Urbana</option>
						  <option value="2">Lightpainting</option>
						  <option value="3">Atardecer-Amanecer</option>
						  <option value="4">Monumentos</option>
						  <option value="5">Ruinas</option>
						  <option value="6">Vehículos-Maquinaria</option>
						  <option value="7">Minería</option>					  
				    </optgroup>
				    <optgroup ng-show="getCurrentUser.vip" label="No sólo Nocturnas">
						  <option value="8">Paisaje</option>
						  <option value="9">Larga Exposición Diurna</option>
						  <option value="10">Urbana</option>
						  <option value="11">Costa</option>
				    </optgroup>
				</select>
				</div>
			</div>
			<!--<div class="row">
				<div class="form-group" >
					<label>Etiquetas</label> <small>Utiliza palabras clave para que tu localización sea más fácil de encontrar.</small>
					<tags-input ng-model="tags" placeholder="Ejemplo: canon, mar, startrail, alicante">
				    </tags-input>
				</div>
			</div>-->
			<div class="row">
				<div class="form-group" >
					<label>Acceso</label> <span ng-show="!localizacion.acceso.length>0" style="color:red">*</span><small>(Se puede llegar con coche? solo a pie? el terreno es peligroso?)</small> <i data-toggle="tooltip" data-placement="top" title="Explica cómo está el acceso: si se puede llegar con coche, o hay que ir andando tantos minutos, si hay cerca zonas peligrosas, etc, etc..." class="fa fa-info-circle"></i>
					<textarea class="form-control" ng-model="localizacion.acceso" rows="3" id="acceso" ng-model="localizacion.acceso" ></textarea>
				</div>
			</div>
			<div class="row">
				<div class="form-group" >
					<p style="margin:0px;"><label>Peligrosidad de la zona</label> <span ng-show="!rate>0" style="color:red">*</span></p>
					<rating ng-model="rate" max="max" readonly="isReadonly" on-hover="hoveringOver(value)" on-leave="overStar = null" style="  font-size: 20px;"></rating>
					<span class="label" ng-class="{'label-warning': percent<30, 'label-info': percent>=30 && percent<70, 'label-success': percent>=70}" ng-show="overStar && !isReadonly" >{{percent}}%</span>
				</div>
			</div>
			<div class="row" ng-hide="localizacion.categoria>7">
				<div class="form-group" >
					<p style="margin:0px;"><label>Contaminación lumínica</label> <span ng-show="!rateCL>0" style="color:red">*</span></p>
					<rating ng-model="rateCL" max="max" readonly="isReadonly" on-hover="hoveringOverCL(value)" on-leave="overStarCL = null" style="font-size: 20px;"></rating>
					<span class="label" ng-class="{'label-warning': percent<30, 'label-info': percent>=30 && percent<70, 'label-success': percent>=70}" ng-show="overStarCL && !isReadonly" >{{percentCL}}%</span>
				</div>
			</div>
			<div class="row">
				<div class="form-group" >
					<label>Algo más que destacar</label>
					<textarea class="form-control" ng-model="localizacion.notasAdicionales" rows="3" id="acceso" ng-model="localizacion.notasAdicionales" ></textarea>
				</div>
			</div>
			<alert type="danger"  close="closeAlert($index)" ng-show="mensajeError.length>0"> {{ mensajeError }}</alert>
			<button class="btn btn-lg btn-success pull-right" type="button" ng-click="crearLocalizacion()" ng-disabled="localizacionCreada">Guardar</button>
		</div>
	</div>
</div>